<div class="admin-dashboard">
  <!-- Sidebar -->
  <aside class="sidebar">
    <!-- Logo RePartir -->
    <div class="logo-section">
      <img src="assets/logo.png" alt="RePartir Logo" class="logo">
    </div>

    <!-- Navigation -->
    <nav class="nav-menu">
      <ul class="nav-list">
        <li class="nav-item">
          <a routerLink="/dashboard" class="nav-link">
            <i class="fas fa-home"></i>
            <span>Tableau de bord</span>
          </a>
        </li>
        <li class="nav-item">
          <a routerLink="/centres-formation" class="nav-link">
            <i class="fas fa-users-cog"></i>
            <span>Gestion utilisateurs</span>
          </a>
        </li>
        <li class="nav-item">
          <a routerLink="/liste-admin" class="nav-link">
            <i class="fas fa-users"></i>
            <span>Administrateurs</span>
          </a>
        </li>
        <li class="nav-item active">
          <a routerLink="/statistiques" class="nav-link">
            <i class="fas fa-chart-bar"></i>
            <span>Statistiques</span>
          </a>
        </li>
      </ul>
    </nav>

        <!-- Déconnexion -->
        <div class="logout-section">
          <a href="#" class="logout-link" (click)="logout()">
            <i class="fas fa-sign-out-alt"></i>
            <span>Déconnexion</span>
          </a>
        </div>
  </aside>

  <!-- Contenu principal -->
  <main class="main-content">
    <!-- En-tête -->
    <header class="header">
      <div class="header-left">
        <!-- Bouton toggle pour mobile si nécessaire -->
      </div>
      <div class="header-right">
        <div class="notifications" (click)="openNotificationsModal()">
          <i class="fas fa-bell"></i>
          <span class="notification-badge" *ngIf="getUnreadNotificationsCount() > 0">{{ getUnreadNotificationsCount() }}</span>
        </div>
        <div class="user-info">
          <span class="user-name">{{ currentUserName }}</span>
        </div>
        <div class="user-avatar">
          <img src="assets/pp.png" alt="Profile">
        </div>
      </div>
    </header>

    <!-- Contenu des statistiques -->
    <div class="statistics-content">
      <div *ngIf="loading" style="text-align: center; padding: 40px;">Chargement des statistiques...</div>
      <!-- Graphique en barres - Inscriptions mensuelles -->
      <div *ngIf="!loading">
      <div class="chart-container">
        <div class="chart-card">
          <h2 class="chart-title">Inscriptions mensuelles ({{ year }})</h2>
          <div class="bar-chart">
            <div class="chart-area">
              <!-- Axe Y -->
              <div class="y-axis">
                <div class="y-label">100</div>
                <div class="y-label">75</div>
                <div class="y-label">50</div>
                <div class="y-label">25</div>
                <div class="y-label">0</div>
              </div>

              <!-- Graphique -->
              <div class="bars-container">
                <div
                  *ngFor="let data of monthlyData"
                  class="bar-wrapper">
                  <div
                    class="bar"
                    [style.height]="getBarHeight(data.value)"
                    [style.background]="data.value > 0 ? 'linear-gradient(to bottom, #3EB2FF, #4CAF50)' : 'transparent'"
                    (mouseenter)="showBarTooltip($event, data)"
                    (mouseleave)="hideTooltip()"
                    (mousemove)="showBarTooltip($event, data)">
                  </div>
                  <div class="bar-label">{{ data.month }}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      </div>
    </div>
  </main>
</div>

<!-- Notifications Modal -->
<app-notifications-modal
  *ngIf="showNotificationsModal"
  [notifications]="notifications"
  (modalClosed)="closeNotificationsModal()"
  (notificationRead)="onNotificationRead($event)">
</app-notifications-modal>

<!-- Tooltip -->
<div
  *ngIf="showTooltip"
  class="tooltip"
  [style.left.px]="tooltipPosition.x + 10"
  [style.top.px]="tooltipPosition.y - 10">
  <div class="tooltip-content">
    <div class="tooltip-month">{{ tooltipData.month }}</div>
    <div class="tooltip-value">{{ tooltipData.value }} inscriptions</div>
  </div>
</div>
